<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>How to do localization with Javascript</title>
	
  <meta content="Kalle Saas" name="author"/>
  
  <meta name="description" content="This Blog is about HTML, CSS, Javascript, SEO, Rails, Flex and all the other good stuff you have to deal with as a Frontend Web Developer">
  
  <link type="application/atom+xml" title="Kalle Saas Client Site Blog" rel="alternate" href="http://feeds.feedburner.com/kalle-saas"/>
  
  
  <script src="/javascripts/shCore.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushAS3.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushCss.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushXml.js" type="text/javascript" charset="utf-8"></script>
  
  <script src="/javascripts/shBrushRuby.js" type="text/javascript" charset="utf-8"></script>
  
  <script src="/javascripts/shBrushJScript.js" type="text/javascript" charset="utf-8"></script>      
	<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/javascripts/jquery.tweet.js" type="text/javascript" charset="utf-8"></script>
	<script src="/javascripts/application.js" type="text/javascript" charset="utf-8"></script>
	
	<script type="text/javascript">
  var addthis_config = {
       username: "fluxsaas"
  }
  </script>
  
	<link rel="stylesheet" href="/stylesheets/default.css" type="text/css" media="screen" charset="utf-8" />
</head>

<body>

<div id="header">
  <p>
    <a class="active" href="/">Blog</a>
    |
    <a href="/portfolio">Portfolio</a>    
  </p>
</div>

<div class="container">
  
<ul class="posts">
  <li class="post">
    
<p class="time-stamp">29 SEPTEMBER 2009</p>
<h1><a href="/2009/09/29/javascript-localization.html">How to do localization with Javascript</a></h1>

<p>
  During AJAX requests or when toggling the state of interface elements, JavaScript may be used to display messages to the User.
  The translate function provides an easy way to translate these messages.
</p> 

<h3>How To Use</h3>
<p>Any JavaScript code that needed to use a string would reference the LOCALIZATION object rather then embedding a string:</p>
<p>You can pass a string with an <strong>"%s"</strong> inside which can be used for string substitution.</p>

<pre class="brush: js;">
  LOCALIZATION.WARNING: 'Achtung vor dem %s, er ist gefährlich !'
</pre>

<pre class="brush: js;">
  alert(translate(LOCALIZATION.WARNING, "Zauberer"));
</pre>


<h3>The <code>localization.[de|en|fr|...].js</code></h3>

<p>
  If you use the LOCALIZATION Object throughout your code, you need only to change the Strings in the
  localization file.
</p>

<p>The german localization file could look like this:</p>

<p><code>localization.de.js</code></p>

<pre class="brush: js;">
  // Example
  var LOCALIZATION = {
    LANGUAGE: 'GERMAN',
    WARNING: 'Achtung vor dem %s, er ist gefährlich !',
    LOADING: 'Bitte warten, Daten werden geladen',
    WELCOME: 'Hallo %s, wie geht\'s dir ?'
  };
</pre>

<p>Make sure that this file is loaded before any other file, which uses the localization.</p>
  
<h3><code>translate.js</code></h3>
<pre class="brush: js;">                
  (function () {
    if (!window.translate) {
      /** 
       * this global function is for string substitution
       * @property {string} string to translate.
       * @property {string} as much 
       * return STRING
       */         
      window.translate = function(){
        var html = [ ];
        var arguments = arguments;
        var string = arguments[0];

        var objIndex = 0;
        var reg = /%s/;
        var parts = [ ];

        /** 
         * analyze the string, extract the parts with the %s identifier.
         */               
        for ( var m = reg.exec(string); m; m = reg.exec(string) ) {  
          // m[0][0] gives undefined in IE
          parts.push(string.substr(0, m[0][0] === "%" ? m.index : m.index));
          parts.push("%s");
          string = string.substr( m.index+m[0].length );
        }
        parts.push(string);

        /** 
         * analyze the parts, replace the %s with the given arguments. 
         * beware of undefined!
         */               
        for (var i = 0; i < parts.length; ++i){
            var part = parts[i];
            if (part && part == "%s"){
              var object = arguments[++objIndex];
              if (object == undefined) {
                html.push("%s");
              }else{
                html.push(object);
              };
            }else{
              html.push(part);
            }            
        }

        /** 
         * Join the array and return as string.
         */
        return html.join('');
      }
    };
  })();
</pre>

<p>
  You can find a test page <a target="_new" href="/examples/translate/">here</a> and the translate.js file <a target="_new" href="/code/translate.js">here</a>.
</p>
<p>
  The code is inspired by the firebug function and the PHP printf function.
</p>
  </li>
  <li>
    <p class="postmetadata alt">
		  <span class="addthis_toolbox addthis_default_style">
			  <a class="addthis_button_facebook">
			   <img src="/images/addthis/facebook_16.png"/>
			  </a>
        <a class="addthis_button_twitter">
          <img src="/images/addthis/twitter_16.png"/>
        </a>
        <a class="addthis_button_misterwong_de"></a>
        <a class="addthis_button_myspace">
          <img src="/images/addthis/myspace_16.png"/>
        </a>
        <a class="addthis_button_wordpress">
          <img src="/images/addthis/wordpress_16.png"/>
        </a>
        <a class="addthis_button_digg">
          <img src="/images/addthis/digg_16.png"/>
        </a>
        <span class="addthis_separator">|</span>
        <a class="addthis_button_expanded">More</a>
        <span class="spezial">
          <a class="addthis_button_email"></a>
          <a class="addthis_button_print"></a>
        </span>
      </span>
    </p>
  </li>
  <li>
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/kallesaas/embed.js"></script><noscript><a href="http://kallesaas.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </li>
</ul>

<div id="side">
  
  <!-- Google Custom Search Element -->
  <div id="cse" style="width:100%;">Loading</div>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript">
    google.load('search', '1');
    google.setOnLoadCallback(function(){
      new google.search.CustomSearchControl('014833945590601956149:dzk6i0prdom').draw('cse');
    }, true);
  </script>
  
  <h2>RSS-Feed</h2>
  <p><a href="http://feeds.feedburner.com/kalle-saas" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a>&nbsp;<a href="http://feeds.feedburner.com/kalle-saas" rel="alternate" type="application/rss+xml">Subscribe in a reader</a></p>
  
  <h2>Featured Projects</h2>
  <ul class="links">
    <li>
      <a target="_new" href="http://2manycolours.com"><img src="/images/2manycolours_logo.png" alt="2manycolours LOGO" width="60" /></a>      
      <h3><a target="_new" href="http://2manycolours.com">2ManyColours</a></h3>
      <p>Mass Customization Fashion Label from Germany</p>
    </li>
    <li>
      <a target="_new" href="http://gameone.de"><img src="/images/gameone.png" width="100" alt="gameone LOGO" /></a>
      <h3><a target="_new" href="http://gameone.de">GameOne - MTV</a></h3>
      <p>Blog- and Community site for the first Game-TV-Show on MTV Germany.</p>
    </li>
    <li>
      <a target="_new" href="http://mtvhome.de/"><img src="/images/MTV_HOME.jpg" width="100" alt="MTV - HOME LOGO" /></a>
      <h3><a target="_new" href="http://mtvhome.de/">MTVHome - MTV</a></h3>
      <p>
        MTV Home is one of MTV Microsite's wich runs on the new developed Rails-Microsite-Engine at MTV Germany.
      </p>
    </li>
    <li>
      <a target="_new" href="http://clubnick.de"><img src="/images/clubnick.png" width="100" alt="MTV CLUBNICK -LOGO" /></a>
      <h3><a target="_new" href="http://clubnick.de">ClubNick - MTV</a></h3>
      <p>
        Game-Based Learning Platform for kids.
      </p>
    </li>    
  </ul>
  
  <h2>Family & Friends</h2>
  <ul class="links">
    <li>
      <h3><a target="_new" href="http://lottasaas.com">http://lottasaas.com</a></h3>
      <p>Modéliste . Creative Pattern Cutter</p>
    </li>    
    <li>
      <h3><a target="_new" href="http://rubyphunk.com/">http://rubyphunk.com/</a></h3>
      <p>Rails Programmer</p>
    </li>        
    <li>
      <h3><a target="_new" href="http://manuelmeurer.com/">http://manuelmeurer.com/</a></h3>
      <p>Rails Programmer</p>
    </li>        
  </ul>  

  <h2>Twitter</h2>
  <div id="tweet">Please Enable your Javascript</div>

</div>
</div>

<div id="footer">
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3399121-1");
pageTracker._trackPageview();
} catch(err) {}</script>

<script type="text/javascript">
//<![CDATA[
(function() {
var links = document.getElementsByTagName('a');
var query = '?';
for(var i = 0; i < links.length; i++) {
if(links[i].href.indexOf('#disqus_thread') >= 0) {
query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
}
}
document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kallesaas/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js"></script>

</body>
</html>
