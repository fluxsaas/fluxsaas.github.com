<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Google Gears Experiment</title>
	
  <meta content="Kalle Saas" name="author"/>
  
  <meta name="description" content="This Blog is about HTML, CSS, Javascript, SEO, Rails, Flex and all the other good stuff you have to deal with as a Frontend Web Developer">
  
  <link type="application/atom+xml" title="Kalle Saas Client Site Blog" rel="alternate" href="http://feeds.feedburner.com/kalle-saas"/>
  
  
  <script src="/javascripts/shCore.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushAS3.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushCss.js" type="text/javascript" charset="utf-8"></script>
  <script src="/javascripts/shBrushXml.js" type="text/javascript" charset="utf-8"></script>
  
  <script src="/javascripts/shBrushRuby.js" type="text/javascript" charset="utf-8"></script>
  
  <script src="/javascripts/shBrushJScript.js" type="text/javascript" charset="utf-8"></script>      
	<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/javascripts/jquery.tweet.js" type="text/javascript" charset="utf-8"></script>
	<script src="/javascripts/application.js" type="text/javascript" charset="utf-8"></script>
	
	<link rel="stylesheet" href="/stylesheets/default.css" type="text/css" media="screen" charset="utf-8" />
</head>

<body>

<div id="header">
  <p>
    <a class="active" href="/">Blog</a>
    |
    <a href="/portfolio">Portfolio</a>    
  </p>
</div>

<div class="container">
  
<ul class="posts">
  <li class="post">
    <p class="time-stamp">14 <span class="caps">AUGUST</span> 2009</p>
<h1><a href="/2009/08/14/google-gears-experiment.html">Google Gears Experiment</a></h1>
<h2>The Result can be found <em><a href="http://kallesaas.com/google-gears/">here</a></em>.</h2>
<p>You need to install <a href="http://gears.google.com/">Google-Gears</a>. to use this software.</p>
<h2>The Setup</h2>
<h3>File Structure:</h3>
<ul class="folders">
<li>
<a href="http://kallesaas.com/google-gears/" >google-gears</a>

<ul class="files">
      <li><a href="http://kallesaas.com/google-gears/index.html.txt" >index.html</a></li>
</ul>

<ul class="folders">
<li>
<a href="http://kallesaas.com/google-gears/stylesheets" >stylesheets</a>
<ul class="files">
          <li><a href="http://kallesaas.com/google-gears/stylesheets/default.css">default.css</a></li>
</ul>
</li>
</ul>

<ul class="folders">
<li>
<a href="http://kallesaas.com/google-gears/javascripts" >javascripts</a>
<ul class="files">
          <li><a href="http://kallesaas.com/google-gears/javascripts/application.js">application.js</a></li>
          <li><a href="http://kallesaas.com/google-gears/javascripts/gears_init.js">gears_init.js</a></li>
          <li><a href="http://kallesaas.com/google-gears/javascripts/vocabulary_creator.js">vocabulary_creator.js</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>The Code</h2>
<h3><span class="caps">HTML</span></h3>
<p>You can find the full code of the <code>index.html</code> file <a href="http://kallesaas.com/google-gears/index.html.txt">here</a>.</p>
<p>Important the correct javascript files:</p>
<pre class="brush: html;">
  ...
  &lt;head&gt;
      &lt;script src="http://www.google.com/jsapi"&gt;&lt;/script&gt;

      &lt;script type="text/javascript" charset="utf-8"&gt;
        google.load("jquery", "1");
      &lt;/script&gt;

      &lt;script src="javascripts/gears_init.js" type="text/javascript" charset="utf-8"&gt;&lt;/script&gt;
      &lt;script src="javascripts/vocabulary_creator.js" type="text/javascript" charset="utf-8"&gt;&lt;/script&gt;
      &lt;script src="javascripts/application.js" type="text/javascript" charset="utf-8"&gt;&lt;/script&gt;
      ...
  &lt;/head&gt;
  &lt;body&gt;
    ...
</pre>
<p>I&#8217;m using the <a href="http://code.google.com/intl/de-DE/apis/ajaxlibs/">Google <span class="caps">AJAX</span> Libraries <span class="caps">API</span></a> to import the JQuery Library.</p>
<p>You can download the <code>gears_init.js</code> <a href="http://code.google.com/apis/gears/tools.html#gears_init">here</a>.</p>
<h3>Javascript</h3>
<p>You can find the Javascript code <a href="http://kallesaas.com/google-gears/javascripts/vocabulary_creator.js">here</a>.</p>
<p>Ok, lets get started!</p>
<p>First, we create a Namespace and a Singleton that holds our Javascript code:</p>
<pre class="brush: js;">
  if (!window.GG) {
    var GG = { };
  }

  GG.VocabularyCreator = (function () { 
    return {
      init: function () {
      }
    };
  })();  
</pre>
<p>Now we can add some functionality.</p>
<p>But wait, what do we actually need ?</p>
<p>We want to:</p>
<ul>
	<li>Add word&#8217;s and theire translation to a list.</li>
	<li>Display the List.</li>
</ul>
<p>Okay, thats sounds not so complicated.</p>
<p>Let&#8217;s have a look at the <a href="http://code.google.com/intl/de-DE/apis/gears/"><span class="caps">API</span></a> for the <a href="http://code.google.com/intl/de-DE/apis/gears/api_database.html">Database</a>.</p>
<p>The first example shows a bunch of JavaScript code:</p>
<pre class="brush: js;">
  &lt;script type="text/javascript" src="gears_init.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript"&gt;
  var db = google.gears.factory.create('beta.database');
  db.open('database-test');
  db.execute('create table if not exists Test' +
             ' (Phrase text, Timestamp int)');
  db.execute('insert into Test values (?, ?)', ['Monkey!', new Date().getTime()]);
  var rs = db.execute('select * from Test order by Timestamp desc');

  while (rs.isValidRow()) {
    alert(rs.field(0) + '@' + rs.field(1));
    rs.next();
  }
  rs.close();
  &lt;/script&gt;
</pre>
<p>With this code we can:</p>
<p><strong>Instantiate the Gears objects: ( see: http://tinyurl.com/nvdhuh )</strong><br />
<pre class="brush: js;"><br />
  var db = google.gears.factory.create(&#8216;beta.database&#8217;);<br />
</pre></p>
<p><strong>Open the Database to read and write:</strong><br />
<pre class="brush: js;"><br />
  db.open(&#8216;database-test&#8217;);<br />
</pre></p>
<p><strong>Execute <em>SQLite</em>:</strong><br />
<pre class="brush: js;"><br />
  // Create a SQLite table:<br />
  db.execute(&#8216;create table if not exists Test&#8217; +<br />
             &#8217; (Phrase text, Timestamp int)&#8217;);</p>
// Insert a value to the table:
db.execute(&#8216;insert into Test values (?, ?)&#8217;, [&#8216;Monkey!&#8217;, new Date().getTime()]);
<p></pre></p>
<p><strong>Read the content of the table:</strong><br />
<pre class="brush: js;"><br />
  // Execute SQLite<br />
  var rs = db.execute(&#8216;select * from Test order by Timestamp desc&#8217;);</p>
// loop over each row:
while (rs.isValidRow()) {
alert(rs.field(0) + &#8216;@&#8217; + rs.field(1));
rs.next();
}

// close the database connection:
rs.close();
<p></pre></p>
<p>That&#8217;s almost all we need for our small app.</p>
<p>Let&#8217;s implement those basics in our app.</p>
<p>We call the private <code>_initDatabase</code> function inside the <code>init()</code> function <br />
to setup the Database:</p>
<h3>The <code>init()</code> function.</h3>
<pre class="brush: js;">
  // init function:
  return {
    init: function () {
      _initDatabase();
    }
  };
</pre>
<h3>The <code>_initDatabase()</code> function.</h3>
<p>More explanation can be found within the code:</p>
<pre class="brush: js;">
    ...
    
    // set class variable's:
    var db;
    var databaseIsCreated = false;
    
    var _initDatabase = function () {
      
      // Check if Gears is installed.
      if (window.google &amp;&amp; google.gears) {
        try {

          // Instantiate Gears objects.
          db = google.gears.factory.create('beta.database');

          // check if the Database is available
          if (db) {
            
            // open a database, see: http://tinyurl.com/l8z4gw
            db.open('Translations');
            
            // Create the Table: EnglishGerman.
            db.execute('create table if not exists EnglishGerman' + 
                          ' (English varchar(255), German varchar(255), Timestamp int)');

            databaseIsCreated = true;

            // Initialize the UI at startup.
            _displayTranslations();
          }

        } catch (ex) {
          console.log('Could not create database: ' + ex.message);
        }
      }
    };
    ...
  })();
</pre>
<p>The structure of the table looks like:</p>
<table>
	<tr>
		<td> <span class="caps">NAME</span> </td>
		<td> English </td>
		<td> German </td>
		<td> Timestamp </td>
	</tr>
	<tr>
		<td> <span class="caps">TYPE</span> </td>
		<td> varchar(255) </td>
		<td> varchar(255) </td>
		<td> date </td>
</table>
<p>Now we have a full featured Gears Database in our hands, Horay!</p>
<p>We can continue with adding content to the SQLLite Table. We do this by <br />
observing (i use <a href="http://jquery.com/">JQuery</a> ) the <span class="caps">HTML</span> Form and add the value&#8217;s of <br />
the input field&#8217;s to the database:</p>
<h3>The <code>_addObserver()</code> function.</h3>
<pre class="brush: js;">
  ...
  var _addObserver = function () {
    
    // Adding the Form Observer
    $('#addVocabularyForm').submit(function (event) {
      var $this = $(this);

      // Read the values of the input fields:
      var german = $this.find('#german').val();
      var english = $this.find('#english').val();
      
      try {
        // Insert the new item.
        var res = db.execute('insert into EnglishGerman values (?, ?, ?)', 
              [english, german, new Date().getTime() ] );

        // if the insertion was successfully, we can also add the entry to the HTML.
        if (res) {
          _addVocabularyToHtml(english, german);
        }
      } catch (exaption) {
        console.log('could not insert entry:' + exaption);
      }

      // Prevent the default action.
      event.preventDefault();
    })
  };
  ...
</pre>
<p>There is not much more to do. You can have a look at the <code>_addVocabularyToHtml</code> function:</p>
<pre class="brush: js;">
  var Translations = function (english, german) {
    $('#vocabularys tbody').prepend(
      $('&lt;tr&gt;&lt;th&gt;' + english + '&lt;/th&gt;&lt;th&gt;' + german + '&lt;/th&gt;&lt;/tr&gt;')
    )    
  };
</pre>
<h2>Conclusion</h2>
<p>This is a really simple experiment for Gears. There are by far more complex possibility&#8217;s to<br />
use Google Gears. The best thing is to read the <a href="http://code.google.com/apis/gears/design.html">introduction</a>.</p>
<p><strong>Unfortunately Apple&#8217;s IPhone does not support Gears. (Apple does not allow third party plugins for the safari browser)</strong></p>
<p>Thanks for reading !</p>
  </li>
  <li>
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/kallesaas/embed.js"></script><noscript><a href="http://kallesaas.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </li>
</ul>

<div id="side">
  <!-- Google Custom Search Element -->
  <div id="cse" style="width:100%;">Loading</div>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript">
    google.load('search', '1');
    google.setOnLoadCallback(function(){
      new google.search.CustomSearchControl('014833945590601956149:dzk6i0prdom').draw('cse');
    }, true);
  </script>

  <h2>Featured Projects</h2>
  <ul class="featured-projects">
    <li>
      <a target="_new" href="http://2manycolours.com"><img src="/images/2manycolours_logo.png" alt="2manycolours LOGO" width="60" /></a>      
      <h3><a target="_new" href="http://2manycolours.com">2ManyColours</a></h3>
      <p>It's all about your Style! </p>
    </li>
    <li>
      <a target="_new" href="http://gameone.de"><img src="/images/gameone.png" width="100" alt="gameone LOGO" /></a>
      <h3><a target="_new" href="http://gameone.de">GameOne - MTV</a></h3>
      <p>MTV GameOne - Die Blog- und Community-Seite zur ersten Games TV-Sendung auf MTV.</p>
    </li>
    <li>
      <a target="_new" href="http://mtvhome.de/"><img src="/images/MTV_HOME.jpg" width="100" alt="MTV - HOME LOGO" /></a>
      <h3><a target="_new" href="http://mtvhome.de/">MTVHome - MTV</a></h3>
      <p>
        MTV Home íst einer der vielen Microsites die auf dem MTV eigenen Microsite-CMS besteht.
      </p>
    </li>
    <li>
      <a target="_new" href="http://clubnick.de"><img src="/images/clubnick.png" width="100" alt="MTV CLUBNICK -LOGO" /></a>
      <h3><a target="_new" href="http://clubnick.de">ClubNick - MTV</a></h3>
      <p>
        Spiele- und Lernplattform für Kinder.
      </p>
    </li>    
  </ul>

  <h2>Twitter</h2>
  <div id="tweet">Please Enable your Javascript</div>

</div>
</div>

<div id="footer">
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3399121-1");
pageTracker._trackPageview();
} catch(err) {}</script>

<script type="text/javascript">
//<![CDATA[
(function() {
var links = document.getElementsByTagName('a');
var query = '?';
for(var i = 0; i < links.length; i++) {
if(links[i].href.indexOf('#disqus_thread') >= 0) {
query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
}
}
document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kallesaas/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>


</body>
</html>
